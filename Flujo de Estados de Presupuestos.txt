
  ğŸ”„ Ciclo de Estados de un Presupuesto

  ğŸ“ BORRADOR

  - Estado inicial al crear un presupuesto
  - Condiciones:
    - Debe tener al menos un detalle (insumo) agregado
    - No debe tener ofertas asociadas
  - Acciones permitidas:
    - âœ… Editar (solo si no tiene ofertas)
    - âœ… Enviar (si tiene detalles)

  ğŸ“¤ ENVIADO

  - CondiciÃ³n para llegar: Desde BORRADOR con puedeEnviar() = true
  - AutomÃ¡tico: Se asigna fecha_presupuesto = fecha actual
  - Acciones permitidas:
    - âœ… Aprobar
    - âœ… Rechazar
    - âœ… Cerrar
    - âœ… Marcar como desierta

  âœ… APROBADO

  - CondiciÃ³n para llegar: Desde ENVIADO con puedeAprobar() = true
  - Permite: Observaciones opcionales
  - Acciones permitidas:
    - âœ… Cerrar
    - âœ… Marcar como desierta

  âŒ RECHAZADO

  - CondiciÃ³n para llegar: Desde ENVIADO con puedeRechazar() = true
  - Requiere: Motivo obligatorio
  - Estado final: No permite mÃ¡s transiciones

  ğŸ¯ ADJUDICADO

  - CondiciÃ³n para llegar: Manualmente desde estados apropiados
  - Significa: Presupuesto ha sido adjudicado a un proveedor
  - Acciones permitidas: Limitadas

  ğŸš« DESIERTA

  - CondiciÃ³n para llegar: Desde ENVIADO o APROBADO
  - Permite: Motivo opcional
  - AcciÃ³n especial: âœ… Reabrir (crea nuevo presupuesto)

  ğŸ”’ CERRADA

  - CondiciÃ³n para llegar: Desde ENVIADO o APROBADO
  - Efecto: Libera insumos (marca como no presupuestados)
  - Estado final: No permite mÃ¡s transiciones

  ğŸ”„ Flujo de Transiciones

  BORRADOR â†’ ENVIADO â†’ APROBADO â†’ CERRADA
      â†“         â†“         â†“
      âŒ     RECHAZADO   DESIERTA â†’ REABRIR (nuevo BORRADOR)
                â†“         â†“
            (FINAL)   ADJUDICADO
                          â†“
                      CERRADA

  âš ï¸ Reglas Importantes

  1. EdiciÃ³n: Solo en BORRADOR y sin ofertas
  2. LiberaciÃ³n de insumos: Solo al CERRAR o RECHAZAR
  3. Reapertura: Solo desde DESIERTA (crea nuevo presupuesto con nro_llamado++)
  4. Ofertas: Se gestionan por separado, no afectan el flujo de estados del presupuesto


Nuevos cambios

 Flujo Completo de Estados

  BORRADOR (creaciÃ³n)
      â†“ [Cualquier usuario: BotÃ³n "Confirmar"]
  ENVIADO (esperando aprobaciÃ³n)
      â†“ [Director: BotÃ³n "Aprobar"]         â†’ [Director: BotÃ³n "Rechazar"]
  APROBADO â† â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ RECHAZADO
      â†“                                           â†“
  [Recibe ofertas]                        [Libera insumos]
      â†“
  [EvalÃºa y adjudica]
      â†“
  ADJUDICADO / DESIERTO / CERRADO

  ---
  ğŸ¯ Comportamiento Actual

  Usuario Normal (no director):

  - âœ… Puede crear presupuesto (BORRADOR)
  - âœ… Puede editar presupuesto en BORRADOR
  - âœ… Puede CONFIRMAR presupuesto (BORRADOR â†’ ENVIADO)
  - âŒ NO puede aprobar ni rechazar

  Director:

  - âœ… Todo lo anterior
  - âœ… Puede APROBAR presupuesto enviado (ENVIADO â†’ APROBADO)
  - âœ… Puede RECHAZAR presupuesto enviado (ENVIADO â†’ RECHAZADO)

  LiberaciÃ³n de Insumos:

  - âœ… Se liberan al rechazar
  - âœ… Se liberan al marcar como desierto
  - âœ… Se liberan al cerrar
  - âœ… Se liberan al anular
  - âŒ NO se liberan al aprobar (quedan bloqueados)
